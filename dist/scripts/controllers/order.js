define(["controllers/controllers"],function(e){e.controller("order",["$rootScope","$scope","$location","Store","Teams","TeamUp",function(e,t,n,r,i,s){function l(){t.views={order:!1}}e.fixStyles();var o=i.queryLocal(),u,a=[];t.orderedMembers=[],t.orderType="";var f=function(n){console.log("123",123);var r=o.members[t.current.group],i=[];_.each(r,function(t){_.each(n,function(n,r){t.uuid===n&&(t.phone&&(e.parsePhoneNumber(t.phone),e.phoneNumberParsed.result===!0&&(t.phoneE164=e.phoneNumberParsed.all.formatting.e164)),t.originalPosition=r,i[r]=t)})}),a=i,t.orderedMembers=i};t.groups=o.teams,n.hash()?u=n.hash():u="order";var c=function(e){l(),t.views[e]=!0};t.setViewTo=function(e){t.$watch(e,function(){n.hash(e),c(e)})},c(u),t.getOrder=function(){var n=t.current.group;t.load=e.ui.dashboard.load,e.statusBar.display(e.ui.order.loadTeam),n!==""&&s._("callOrderGet",{second:n}).then(function(n){t.orderType=n.sortBy,f(n.order),t.load="",e.statusBar.off()})},t.sortableOptions={animation:150,scroll:!1,draggable:"tr"},t.confirmOrder=function(){var n=t.current.group,r=[],i={};e.statusBar.display(e.ui.teamup.saveTeam),i.sortBy=t.orderType,_.each(a,function(e,t){r[t]=e.uuid}),i.order=r,s._("callOrderSave",{second:n},i).then(function(n){e.notifier.success(e.ui.order.orderSaved),e.statusBar.off(),t.orderType=n.sortBy,f(n.order)})}}])});