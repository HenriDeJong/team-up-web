define(["directives/directives"],function(e){e.directive("chosen",function(){var e=function(e,t){e.$watch("receviersList",function(){t.trigger("liszt:updated")}),e.$watch("message.receviers",function(){angular.element(t[0]).trigger("liszt:updated")}),t.chosen()};return{restrict:"A",link:e}}),e.directive("uploader",[function(){return{restrict:"E",scope:{action:"@"},controller:["$scope","$rootScope","Session",function(e,t,n){e.progress="0%",e.avatar="",e.uploadLabel=t.ui.profile.click2upload;var r=n.get();r&&(e.sessionId=r),e.sendFile=function(n){var r=angular.element(n).parents("form");if(angular.element(n).val()=="")return!1;r.attr("action",e.action),e.$apply(function(){e.progress="0%"}),r.ajaxSubmit({type:"POST",headers:{"X-SESSION_ID":e.sessionId},uploadProgress:function(t,n,r,i){e.$apply(function(){e.progress=i+"%"})},error:function(e,t,n,i){r.removeAttr("action")},success:function(i,s,o,u){var a=angular.element(n).val().split("\\"),f=a[a.length-1];r.removeAttr("action"),e.$apply(function(){e.avatar=f;var n="",r=$(".roundedPicLarge").attr("style"),i=0,s,o,u;try{i=parseInt(r.split("?")[1].split("&")[0].split("=")[1],10)}catch(a){console.log(a)}e.$parent.data.clientId?(s=e.$parent.data.clientId,u=t.ui.profile.profileImgSuccessfullyUploaded,o="client"):e.$parent.data.uuid&&(s=e.$parent.data.uuid,u=t.ui.profile.profileImgSuccessfullyUploaded,o="team"),e.$parent.$root.avatarChange(s),t.notifier.success(u),t.showChangedAvatar(o,s);var l=parseInt(i,10)+e.$parent.$root.getAvatarChangeTimes(s),c=r.replace("width="+i,"width="+l);$(".roundedPicLarge").attr("style",c)})}})}}],link:function(e,t,n,r){t.find(".fake-uploader").click(function(){t.find('input[type="file"]').click()})},replace:!1,templateUrl:"views/uploader.html"}}]),e.directive("profile",[function(){return{restrict:"E",scope:{memberId:"@"},controller:["$scope",function(e){e.loadMember=function(e){}}],link:function(e,t,n,r){console.log("profile directive ->",n.memberId)},replace:!1,templateUrl:"views/profileTemplate.html"}}]),e.directive("ngenter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){t.which===13&&(e.$apply(function(){e.$eval(n.ngenter)}),t.preventDefault())})}}),e.directive("backImg",function(){return function(e,t,n){var r=n.backImg;t.css({"background-image":"url("+r+")","background-size":"cover"})}}),e.directive("linkIconHovered",function(){return{link:function(e,t,n){t.parent().bind("mouseenter",function(){t.removeClass("icon-link"),t.addClass("icon-link2")}),t.parent().bind("mouseleave",function(){t.removeClass("icon-link2"),t.addClass("icon-link")})}}})});