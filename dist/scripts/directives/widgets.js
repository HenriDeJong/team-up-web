define(["directives/directives"],function(e){e.directive("chosen",function(){var e=function(e,t){e.$watch("receviersList",function(){t.trigger("liszt:updated")}),e.$watch("message.receviers",function(){angular.element(t[0]).trigger("liszt:updated")}),t.chosen()};return{restrict:"A",link:e}}),e.directive("uploader",[function(){return{restrict:"E",scope:{action:"@"},controller:["$scope","$rootScope","Session",function(e,t,n){e.progress=0,e.avatar="",e.uploadLabel=t.ui.profile.click2upload;var r=n.get();r&&(e.sessionId=r),e.sendFile=function(t){var n=angular.element(t).parents("form");if(angular.element(t).val()=="")return!1;n.attr("action",e.action),e.$apply(function(){e.progress=0}),n.ajaxSubmit({type:"POST",headers:{"X-SESSION_ID":e.sessionId},uploadProgress:function(t,n,r,i){e.$apply(function(){e.progress=i})},error:function(e,t,r,i){n.removeAttr("action"),console.log("response : ",r)},success:function(r,i,s,o){var u=angular.element(t).val().split("\\"),a=u[u.length-1];n.removeAttr("action"),e.$apply(function(){e.avatar=a})}})}}],link:function(e,t,n,r){t.find(".fake-uploader").click(function(){t.find('input[type="file"]').click()})},replace:!1,templateUrl:"views/uploader.html"}}]),e.directive("profile",[function(){return{restrict:"E",scope:{memberId:"@"},controller:["$scope",function(e){e.loadMember=function(e){}}],link:function(e,t,n,r){console.log("profile directive ->",n.memberId)},replace:!1,templateUrl:"views/profileTemplate.html"}}]),e.directive("ngenter",function(){return function(e,t,n){t.bind("keydown keypress",function(t){t.which===13&&(e.$apply(function(){e.$eval(n.ngenter)}),t.preventDefault())})}})});