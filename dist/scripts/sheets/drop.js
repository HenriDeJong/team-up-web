function handleDrop(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;handleFiles(t)}function handleFile(e){var t=e.target.files;handleFiles(t)}function handleFiles(e){rABS=document.getElementsByName("userabs")[0].checked,use_worker=document.getElementsByName("useworker")[0].checked;var t,n;for(t=0,n=e[t];t!=e.length;++t){var r=new FileReader,i=n.name;r.onload=function(e){typeof console!="undefined"&&console.log("onload",new Date,rABS,use_worker);var t=e.target.result;if(use_worker)xlsxworker(t,process_wb);else{var n;if(rABS)n=XLSX.read(t,{type:"binary"});else{var r=fixdata(t);n=XLSX.read(btoa(r),{type:"base64"})}process_wb(n)}},rABS?r.readAsBinaryString(n):r.readAsArrayBuffer(n),$("#UploadStepSelectFile").hide(),addBreadcrumb("Verwerken")}}function handleDragover(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"}var rABS=typeof FileReader!="undefined"&&typeof FileReader.prototype!="undefined"&&typeof FileReader.prototype.readAsBinaryString!="undefined";rABS||(document.getElementsByName("userabs")[0].disabled=!0,document.getElementsByName("userabs")[0].checked=!1);var use_worker=typeof Worker!="undefined";use_worker||(document.getElementsByName("useworker")[0].disabled=!0,document.getElementsByName("useworker")[0].checked=!1);var transferable=use_worker;transferable||(document.getElementsByName("xferable")[0].disabled=!0,document.getElementsByName("xferable")[0].checked=!1);var wtf_mode=!1,drop=document.getElementById("drop");drop.addEventListener&&(drop.addEventListener("dragenter",handleDragover,!1),drop.addEventListener("dragover",handleDragover,!1),drop.addEventListener("drop",handleDrop,!1));var xlf=document.getElementById("xlf");xlf.addEventListener&&xlf.addEventListener("change",handleFile,!1);